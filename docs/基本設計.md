# 基本設計書

## 1. システム概要
Windows (x64) C#/.NET で開発する常駐アプリ。
指定したゲームの `.exe` に紐づくウィンドウのスクリーンショットを取得し、
OpenAI GPT-4o mini Vision API で OCR＋翻訳して表示する。

---

## 2. 画面仕様（UI）
### 2.1 ウィンドウ構成
- タイトルバー：閉じる（×）・最小化（−）
- 最大化ボタン：無効
- ウィンドウサイズ：可変
- 基本は1画面構成

### 2.2 UI要素
| UI要素 | 種別 | 内容 |
|------|------|------|
| 対象EXEパス表示欄 | TextBox（READONLY） | 現在指定しているゲーム実行ファイル |
| 対象EXE選択ボタン | Button | ファイルダイアログから `.exe` を選択 |
| キャプチャ実行ボタン | Button | 指定EXEのアクティブウィンドウを撮影 → API実行 |
| 追加プロンプト入力欄 | TextBox | 最大200文字 |
| ログ表示領域 | TextBox（READONLY） | 最新5行を表示 |
| 実行結果表示欄 | TextBox（READONLY） | OCR＋翻訳結果を表示、コピペ可 |

---

## 3. API仕様
- 使用モデル：**GPT-4o mini Vision**
- 入力：スクリーンショット（png）
- 出力：画像内英文 + 日本語翻訳
- エラー時はログ表示

---

## 4. 設定（iniファイルで外部管理）
`settings.ini`（同一フォルダに配置）

| 項目 | 内容 | 必須 |
|---|---|---|
| api_key | OpenAI API Key | 必須 |
| exe_path | 対象EXEフルパス | 任意 |
| prompt_prefix | 追加プロンプトのデフォルト値 | 任意 |
| image_scale | 領域縮小等の処理（将来用） | 任意 |
| model | GPT-4o-mini 固定（将来拡張用） | 任意 |

- アプリ起動時に読み込み
- 存在しない場合は初回起動時に自動生成

---

## 5. スクリーンショット仕様
- 対象EXEのウィンドウハンドルから取得
- ウィンドウ非アクティブ時はアクティブ化（失敗時ログ）
- 画像形式：PNG 24bit以上
- サイズが大きい場合は縮小処理

---

## 6. ログ仕様
- 内部保持：50件
- 表示：最新5件
- 出力例：
  - `[INFO] Capturing window...`
  - `[ERROR] API request failed (401)`

---

## 7. 実装クラス構成（案）
- `MainForm.cs` … UI
- `CaptureService.cs` … スクリーンショット取得処理
- `OpenAIService.cs` … API送信
- `Settings.cs` … ini読込管理
- `Logger.cs` … ログ管理（UI連携）

---

## 8. 拡張性
- iniファイルでモデル切替を将来的に可能
- 対象ウィンドウ複数対応（非必須）
- 自動定期キャプチャ機能（将来的に）
