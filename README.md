# TranslationAtGPT

画面のスクリーンショットを撮影⇒GPTでOCR＆翻訳を自動で行ってくれるWindows用プログラム

## Version 1.0

基本的なウィンドウキャプチャと翻訳機能を実装した最初のリリースです。

## セットアップ

### 設定ファイルの準備

1. `settings.ini.example` を `settings.ini` にコピー
2. `settings.ini` を編集して、以下の項目を設定：
   - `api_key`: OpenAI APIキーを設定
   - `default_prompt`: 翻訳時のデフォルトプロンプトを設定（任意）

```ini
[OpenAI]
api_key=sk-xxxxxxxxxxxxxxxxxxxx
default_prompt=以下の画像内から英語テキストのみ抽出し、まず原文をそのまま出力し、その下に日本語翻訳を記載してください。説明文や余計な文章は一切出力しないでください。ゲーム内のテキストであることを考慮し、自然な日本語訳にしてください。
```

**注意**: `settings.ini` ファイルは `.gitignore` に含まれているため、Gitにコミットされません。APIキーを安全に保護してください。

## 主な機能

- ✅ ウィンドウ一覧の取得と選択
- ✅ 選択したウィンドウのスクリーンショット撮影
- ✅ 背面ウィンドウのキャプチャ対応（PrintWindow API使用）
- ✅ 最小化ウィンドウのキャプチャ対応（DWM API使用）
- ✅ 選択したウィンドウのスクリーンショット撮影（背面ウィンドウにも対応）
- ✅ OpenAI GPT-4o-mini を使用したOCR＋翻訳
- ✅ キャプチャ画像のサムネイル表示
- ✅ 追加プロンプト入力による翻訳カスタマイズ
- ✅ キャプチャ画像の自動保存（capturesディレクトリ）
- ✅ 大きな画像の自動縮小（2000px以上）

## 使い方

1. アプリケーションを起動
2. 「更新」ボタンでウィンドウ一覧を取得
3. 翻訳したいウィンドウをドロップダウンから選択
4. （オプション）追加プロンプトを入力
5. 「キャプチャ実行」ボタンをクリック
6. サムネイルと翻訳結果が表示される

## 注意事項

### 最小化ウィンドウについて

- 最小化されたウィンドウのキャプチャに対応していますが、Windowsのシステム仕様により正常に取得できない場合があります
- 最小化状態では以下の制約があります：
  - DWM (Desktop Window Manager) が無効な環境ではキャプチャできません
  - 一部のアプリケーションでは最小化時にウィンドウの内容が保持されず、黒い画面になる場合があります
  - DirectXやゲームエンジンを使用するアプリケーションは最小化状態でキャプチャできない場合があります
- キャプチャに失敗する場合は、ウィンドウを通常の状態（最小化していない状態）に戻してから再度お試しください

### 動作環境

- Windows Vista以降（DWM API使用のため）
- .NET 8.0以降
## 技術的な詳細

### 背面ウィンドウキャプチャ

本アプリケーションは Windows API の `PrintWindow` 関数を使用して、背面にあるウィンドウ（他のウィンドウの後ろに隠れている、またはフォーカスを失っているウィンドウ）でもスクリーンショットを撮影できます。

- **使用API**: `PrintWindow` (user32.dll) および GDI関数
- **フォールバック機能**: `PrintWindow` が失敗した場合は、従来の `CopyFromScreen` 方式を使用
- **対応プラットフォーム**: Windows専用（Windows API依存）
